<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Search for similar spatial pattern — lsp_search • motif</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Search for similar spatial pattern — lsp_search" />
<meta property="og:description" content="Searches for areas with similar spatial patterns in categorical data.
It accepts a categorical raster dataset with one or more attributes, and compares it to the second (usually larger) dataset with the same attributes.
The first dataset is either compared to a whole area, areas divided into regular windows, or areas divided into irregular windows from the second dataset.
This function allows for several types of comparisons using different representations of spatial patterns, including &quot;coma&quot; (co-occurrence matrix), &quot;cove&quot; (co-occurrence vector), &quot;cocoma&quot; (co-located co-occurrence matrix), &quot;cocove&quot; (co-located co-occurrence vector), &quot;wecoma&quot; (weighted co-occurrence matrix), &quot;wecove&quot; (weighted co-occurrence vector), &quot;incoma&quot; (integrated co-occurrence matrix), &quot;incove&quot; (integrated co-occurrence vector). These representations are created for both datasets, and next a distance between them is calculated using a selected measure from the philentropy::distance function.
Additional parameters, such as neighbourhood or normalization types, are also available." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motif</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/cluster.html">Cluster</a>
    </li>
    <li>
      <a href="../articles/articles/compare.html">Compare</a>
    </li>
    <li>
      <a href="../articles/articles/search.html">Search</a>
    </li>
    <li>
      <a href="../articles/articles/signatures.html">Signatures</a>
    </li>
    <li>
      <a href="../articles/intro.html">intro</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Nowosad/motif/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Search for similar spatial pattern</h1>
    <small class="dont-index">Source: <a href='https://github.com/Nowosad/motif/blob/master/R/lsp_search.R'><code>R/lsp_search.R</code></a></small>
    <div class="hidden name"><code>lsp_search.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Searches for areas with similar spatial patterns in categorical data.
It accepts a categorical raster dataset with one or more attributes, and compares it to the second (usually larger) dataset with the same attributes.
The first dataset is either compared to a whole area, areas divided into regular windows, or areas divided into irregular windows from the second dataset.
This function allows for several types of comparisons using different representations of spatial patterns, including "coma" (co-occurrence matrix), "cove" (co-occurrence vector), "cocoma" (co-located co-occurrence matrix), "cocove" (co-located co-occurrence vector), "wecoma" (weighted co-occurrence matrix), "wecove" (weighted co-occurrence vector), "incoma" (integrated co-occurrence matrix), "incove" (integrated co-occurrence vector). These representations are created for both datasets, and next a distance between them is calculated using a selected measure from the <code><a href='https://rdrr.io/pkg/philentropy/man/distance.html'>philentropy::distance</a></code> function.
Additional parameters, such as neighbourhood or normalization types, are also available.</p>
    </div>

    <pre class="usage"><span class='fu'>lsp_search</span>(
  <span class='no'>x</span>,
  <span class='no'>y</span>,
  <span class='no'>type</span>,
  <span class='no'>dist_fun</span>,
  <span class='kw'>window</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>neighbourhood</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>ordered</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>repeated</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>normalization</span> <span class='kw'>=</span> <span class='st'>"pdf"</span>,
  <span class='kw'>wecoma_fun</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
  <span class='kw'>wecoma_na_action</span> <span class='kw'>=</span> <span class='st'>"replace"</span>,
  <span class='no'>...</span>
)

<span class='co'># S3 method for stars</span>
<span class='fu'>lsp_search</span>(
  <span class='no'>x</span>,
  <span class='no'>y</span>,
  <span class='no'>type</span>,
  <span class='no'>dist_fun</span>,
  <span class='kw'>window</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>neighbourhood</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>ordered</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>repeated</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>normalization</span> <span class='kw'>=</span> <span class='st'>"pdf"</span>,
  <span class='kw'>wecoma_fun</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
  <span class='kw'>wecoma_na_action</span> <span class='kw'>=</span> <span class='st'>"replace"</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Object of class <code>stars</code> or <code>stars_proxy</code>. It should have one attribute (for <code>"coma"</code>, <code>"cove"</code>), two attributes (<code>"cocoma"</code>, <code>"cocove"</code>, <code>"wecoma"</code>, <code>"wecove"</code>), two or more attributes (<code>"incoma"</code>, <code>"incove"</code>), or any number of attributes suitable for user-defined functions.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Object of class <code>stars</code> or <code>stars_proxy</code>. It should have one attribute (for <code>"coma"</code>, <code>"cove"</code>), two attributes (<code>"cocoma"</code>, <code>"cocove"</code>, <code>"wecoma"</code>, <code>"wecove"</code>), two or more attributes (<code>"incoma"</code>, <code>"incove"</code>), or any number of attributes suitable for user-defined functions.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of the calculated signature. It can be <code>"coma"</code> (co-occurrence matrix), <code>"cove"</code> (co-occurrence vector), <code>"cocoma"</code> (co-located co-occurrence matrix), <code>"cocove"</code> (co-located co-occurrence vector), <code>"wecoma"</code> (weighted co-occurrence matrix), <code>"wecove"</code> (weighted co-occurrence vector), <code>"incoma"</code> (integrated co-occurrence matrix), <code>"incove"</code> (integrated co-occurrence vector), or any function that can summarize <code>stars</code> objects.</p></td>
    </tr>
    <tr>
      <th>dist_fun</th>
      <td><p>Distance measure used. This function uses the <code><a href='https://rdrr.io/pkg/philentropy/man/distance.html'>philentropy::distance</a></code> function in the background. Run <code><a href='https://rdrr.io/pkg/philentropy/man/getDistMethods.html'>philentropy::getDistMethods()</a></code> to find possible distance measures.</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>Specifies areas for analysis. It can be either: <code>NULL</code>, a numeric value, or an <code>sf</code> object. If <code>window=NULL</code> calculations are performed for a whole area. If the <code>window</code> argument is numeric, it is a length of the side of a square-shaped block of cells. Expressed in the numbers of cells, it defines the extent of a local pattern. If an <code>sf</code> object is provided, each feature (row) defines the extent of a local pattern. The <code>sf</code> object should have one attribute (otherwise, the first attribute is used as an id).</p></td>
    </tr>
    <tr>
      <th>neighbourhood</th>
      <td><p>The number of directions in which cell adjacencies are considered as neighbours:
4 (rook's case) or 8 (queen's case). The default is 4.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>The share of NA cells to allow metrics calculation.</p></td>
    </tr>
    <tr>
      <th>ordered</th>
      <td><p>For <code>"cove"</code>, <code>"cocove"</code>, <code>"wecove"</code> and <code>"incove"</code> only. The type of pairs considered.
Either "ordered" (TRUE) or "unordered" (FALSE).
The default is TRUE.</p></td>
    </tr>
    <tr>
      <th>repeated</th>
      <td><p>For <code>"incove"</code> only. Should the repeated co-located co-occurrence matrices be used?
Either "ordered" (TRUE) or "unordered" (FALSE).
The default is TRUE.</p></td>
    </tr>
    <tr>
      <th>normalization</th>
      <td><p>For <code>"cove"</code>, <code>"cocove"</code>, <code>"wecove"</code> and <code>"incove"</code> only. Should the output vector be normalized?
Either "none" or "pdf".
The "pdf" option normalizes a vector to sum to one.
The default is "pdf".</p></td>
    </tr>
    <tr>
      <th>wecoma_fun</th>
      <td><p>For <code>"wecoma"</code> and <code>"wecove"</code> only. Function to calculate values from adjacent cells to contribute to exposure matrix, <code>"mean"</code> - calculate average values of local population densities from adjacent cells, <code>"geometric_mean"</code> - calculate geometric mean values of local population densities from adjacent cells, or <code>"focal"</code> assign a value from the focal cell</p></td>
    </tr>
    <tr>
      <th>wecoma_na_action</th>
      <td><p>For <code>"wecoma"</code> and <code>"wecove"</code> only. Decides on how to behave in the presence of missing values in <code>w</code>. Possible options are <code>"replace"</code>, <code>"omit"</code>, <code>"keep"</code>. The default, <code>"replace"</code>, replaces missing values with 0, <code>"omit"</code> does not use cells with missing values, and <code>"keep"</code> keeps missing values.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for the <code><a href='https://rdrr.io/pkg/philentropy/man/distance.html'>philentropy::distance</a></code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code>stars</code>.
It has three attributes:
(1) <code>id</code> - an id of each window.
For irregular windows, it is the values provided in the <code>window</code> argument,
(2) <code>na_prop</code> - share (0-1) of <code>NA</code> cells for each window in the <code>y</code> object,
(3) <code>dist</code>- calculated distance between the <code>x</code> object and each window in the <code>y</code> object</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>stars</span>)

<span class='no'>landcover</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/stars/man/read_stars.html'>read_stars</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"raster/landcover2015.tif"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"motif"</span>))
<span class='fu'><a href='https://rdrr.io/pkg/stars/man/plot.html'>plot</a></span>(<span class='no'>landcover</span>)</div><div class='img'><img src='lsp_search-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>ext</span> <span class='kw'>=</span> <span class='fu'>st_bbox</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>xmin</span> <span class='kw'>=</span> -<span class='fl'>249797.344531127</span>, <span class='kw'>xmax</span> <span class='kw'>=</span> -<span class='fl'>211162.693944285</span>,
                <span class='kw'>ymin</span> <span class='kw'>=</span> -<span class='fl'>597280.143035389</span>, <span class='kw'>ymax</span> <span class='kw'>=</span> -<span class='fl'>558645.492448547</span>),
                <span class='kw'>crs</span> <span class='kw'>=</span> <span class='fu'>st_crs</span>(<span class='no'>landcover</span>))

<span class='no'>landcover_ext</span> <span class='kw'>=</span> <span class='no'>landcover</span>[<span class='no'>ext</span>]
<span class='fu'><a href='https://rdrr.io/pkg/stars/man/plot.html'>plot</a></span>(<span class='no'>landcover_ext</span>)</div><div class='img'><img src='lsp_search-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>ecoregions</span> <span class='kw'>=</span> <span class='fu'>read_sf</span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"vector/ecoregions.gpkg"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"motif"</span>))
<span class='fu'><a href='https://rdrr.io/pkg/stars/man/plot.html'>plot</a></span>(<span class='no'>ecoregions</span>[<span class='st'>"id"</span>])</div><div class='img'><img src='lsp_search-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>s1</span> <span class='kw'>=</span> <span class='fu'>lsp_search</span>(<span class='no'>landcover_ext</span>, <span class='no'>landcover</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"cove"</span>,
  <span class='kw'>dist_fun</span> <span class='kw'>=</span> <span class='st'>"jensen-shannon"</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; <span class='message'>Metric: 'jensen-shannon' using unit: 'log2'.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/stars/man/plot.html'>plot</a></span>(<span class='no'>s1</span>[<span class='st'>"dist"</span>])</div><div class='img'><img src='lsp_search-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>s2</span> <span class='kw'>=</span> <span class='fu'>lsp_search</span>(<span class='no'>landcover_ext</span>, <span class='no'>landcover</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"cove"</span>,
  <span class='kw'>dist_fun</span> <span class='kw'>=</span> <span class='st'>"jensen-shannon"</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='no'>ecoregions</span>[<span class='st'>"id"</span>])</div><div class='output co'>#&gt; <span class='message'>Metric: 'jensen-shannon' using unit: 'log2'.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/stars/man/plot.html'>plot</a></span>(<span class='no'>s2</span>[<span class='st'>"dist"</span>])</div><div class='img'><img src='lsp_search-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


