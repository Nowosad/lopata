<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the motif package • motif</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the motif package">
<meta property="og:description" content="motif">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motif</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/articles/cluster.html">Spatial patterns' clustering</a>
    </li>
    <li>
      <a href="../articles/articles/compare.html">Spatial patterns' comparision</a>
    </li>
    <li>
      <a href="../articles/articles/search.html">Spatial patterns' search</a>
    </li>
    <li>
      <a href="../articles/articles/signatures.html">Types of spatial patterns' signatures</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction to the motif package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Nowosad/motif/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the motif package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Nowosad/motif/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>The <strong>motif</strong> package implements ideas of the pattern-based spatial analysis in R. Its role is to describe spatial patterns of categorical raster data for any defined regular and irregular areas. Patterns are represented quantitatively using built-in signatures based on co-occurrence matrices but also allows for any user-defined functions. It also enables spatial analysis such as search, change detection, and clustering to be performed on spatial patterns.</p>
<p>The <strong>motif</strong> package works on raster data represented by <code>stars</code> objects. It has several example datasets, including <code>"raster/landcover2015.tif"</code>. This file contains a land cover data for New Guinea, with seven possible categories: (1) agriculture, (2) forest, (3) grassland, (5) settlement, (6) shrubland, (7) sparse vegetation, and (9) water.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">motif</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stars</span>)
<span class="co">#&gt; Loading required package: abind</span>
<span class="co">#&gt; Loading required package: sf</span>
<span class="co">#&gt; Linking to GEOS 3.8.1, GDAL 2.4.4, PROJ 7.0.0</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="no">landcover</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stars/man/read_stars.html">read_stars</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"raster/landcover2015.tif"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"motif"</span>))</pre></body></html></div>
<p><img src="intro_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div id="signatures" class="section level2">
<h2 class="hasAnchor">
<a href="#signatures" class="anchor"></a>Signatures</h2>
<div id="whole-area" class="section level3">
<h3 class="hasAnchor">
<a href="#whole-area" class="anchor"></a>Whole area</h3>
<p>We can see that most of the island is covered by forest, with some agriculture and smaller areas of the other classes. It is also reasonably easy to describe these proportions (so-called composition) numerically - we just need to count cells of each category for the whole data.</p>
<p>We can use the <code><a href="../reference/lsp_thumbprint.html">lsp_thumbprint()</a></code> function for this. It requires a <code>stars</code> object as the first input and the type of a signature to calculate - <code>"composition"</code> in this case. There are also several additional arguments, including <code>threshold</code> - a share (between 0 and 1) of NA cells to allow signature calculation and <code>normalization</code> - decision if the output vector should be normalized.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">landcover_comp</span> <span class="kw">=</span> <span class="fu"><a href="../reference/lsp_thumbprint.html">lsp_thumbprint</a></span>(<span class="no">landcover</span>,
                                <span class="kw">type</span> <span class="kw">=</span> <span class="st">"composition"</span>,
                                <span class="kw">threshold</span> <span class="kw">=</span> <span class="fl">1</span>,
                                <span class="kw">normalization</span> <span class="kw">=</span> <span class="st">"none"</span>)
<span class="no">landcover_comp</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;      id na_prop signature        </span>
<span class="co">#&gt; * &lt;int&gt;   &lt;dbl&gt; &lt;list&gt;           </span>
<span class="co">#&gt; 1     1   0.666 &lt;int[,7] [1 × 7]&gt;</span></pre></body></html></div>
<p>The output of <code><a href="../reference/lsp_thumbprint.html">lsp_thumbprint()</a></code>, <code>landcover_comp</code>, has a new class <code>lsp</code>. It is a tibble with three columns:</p>
<ul>
<li>
<code>id</code> - an id of each window (area)</li>
<li>
<code>na_prop</code> - share (0-1) of <code>NA</code> cells for each window</li>
<li>
<code>signature</code> - a list-column containing with calculated signatures</li>
</ul>
<p>We can take a look at the last column:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">landcover_comp</span>$<span class="no">signature</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;           1       2     3    4    5     6      7</span>
<span class="co">#&gt; [1,] 862001 8122776 84482 4311 2677 78555 203444</span></pre></body></html></div>
<p>It is a list of signatures. In this case, we have just one signature describing the whole area in the form of a numeric vector. It contains how many cells belong to each land cover category. For example, there are 8122776 cells of forest, but only 2677 cells of shrubland.</p>
<!-- However, it is not that easy to describe landscape patterns numericaly.  -->
<!-- We can try to... -->
<!-- ... -->
<!-- ... -->
</div>
<div id="regular-local-landscapes" class="section level3">
<h3 class="hasAnchor">
<a href="#regular-local-landscapes" class="anchor"></a>Regular local landscapes</h3>
<p>Another approach would be to divide this large area into many regular rectangles (we refer to them as local landscapes) and to calculate a signature in each of them. The previously used signature, <code>"composition"</code> has one important flaw though. It only describes how many cells of each category we have. However, it does not distinguish an area with the left half of forest and right half of agriculture from an area with forest mixed with agriculture (think of a green-yellow checkerboard). Gladly, several more types of signatures do exist. It includes a co-occurrence matrix (<code>type = "coma"</code>). <code>"coma"</code> goes to each cell, looks at its value, looks at the values of its neighbors and counts how many neighbors of each class our central cell has.</p>
<p><img src="intro_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>This time, we set the <code>window</code> argument to <code>200</code>, which means that each local landscape will consist of 200 by 200 cells. In this example, each cell has a resolution of 300 by 300 meters, therefore a local landscape will be 60000 by 60000 meters (60 by 60 kilometers).</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">landcover_coma</span> <span class="kw">=</span> <span class="fu"><a href="../reference/lsp_thumbprint.html">lsp_thumbprint</a></span>(<span class="no">landcover</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"coma"</span>, <span class="kw">window</span> <span class="kw">=</span> <span class="fl">200</span>)
<span class="no">landcover_coma</span>
<span class="co">#&gt; # A tibble: 232 x 3</span>
<span class="co">#&gt;       id na_prop signature        </span>
<span class="co">#&gt;  * &lt;int&gt;   &lt;dbl&gt; &lt;list&gt;           </span>
<span class="co">#&gt;  1     3  0.0992 &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  2     4  0.145  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  3    38  0.255  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  4    39  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  5    40  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  6    41  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  7    42  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  8    43  0.115  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  9    77  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt; 10    78  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt; # … with 222 more rows</span></pre></body></html></div>
<p>Now, we have one row per local landscape, where each local landscape is described by an id (<code>id</code>), the proportion of cells with <code>NA</code>s (<code>na_prop</code>), and a signature (<code>signature</code>). For example, the first signature looks like this:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">landcover_coma</span>$<span class="no">signature</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="co">#&gt;    1      2 3 4 5 6    7</span>
<span class="co">#&gt; 1 32     47 0 2 0 0    6</span>
<span class="co">#&gt; 2 47 141250 0 7 0 0  226</span>
<span class="co">#&gt; 3  0      0 0 0 0 0    0</span>
<span class="co">#&gt; 4  2      7 0 4 0 0    0</span>
<span class="co">#&gt; 5  0      0 0 0 0 0    0</span>
<span class="co">#&gt; 6  0      0 0 0 0 0    0</span>
<span class="co">#&gt; 7  6    226 0 0 0 0 1462</span></pre></body></html></div>
<p>It is a matrix where each row and column represent subsequent land cover classes. For example, 141250 times forest cell is next to anther forest cell, and 226 times water cell is next to forest cell. You can learn more about this signature at <a href="https://nowosad.github.io/comat/articles/coma.html" class="uri">https://nowosad.github.io/comat/articles/coma.html</a>. Additional signatures are described in the <a href="https://nowosad.github.io/motif/articles/articles/signatures.html">Spatial patterns’ signatures</a> vignette.</p>
</div>
<div id="irregular-local-landscapes" class="section level3">
<h3 class="hasAnchor">
<a href="#irregular-local-landscapes" class="anchor"></a>Irregular local landscapes</h3>
<p>The <strong>motif</strong> package also allows using irregular regions based on the user-provided polygons. It has an example spatial vector dataset, <code>ecoregions.gpkg</code>, which contains terrestrial ecoregions for New Guinea from <a href="https://ecoregions2017.appspot.com/" class="uri">https://ecoregions2017.appspot.com/</a>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">ecoregions</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_read.html">read_sf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"vector/ecoregions.gpkg"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"motif"</span>))</pre></body></html></div>
<p>This dataset has 22 rows, where each row relates to one ecoregion. Each ecoregion is also related to a unique value in the <code>id</code> column.</p>
<p><img src="intro_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>Now, we need to provide this dataset and its identity column to the <code>window</code> argument of <code><a href="../reference/lsp_thumbprint.html">lsp_thumbprint()</a></code>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">landcover_coma_e</span> <span class="kw">=</span> <span class="fu"><a href="../reference/lsp_thumbprint.html">lsp_thumbprint</a></span>(<span class="no">landcover</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"coma"</span>, <span class="kw">window</span> <span class="kw">=</span> <span class="no">ecoregions</span>[<span class="st">"id"</span>])
<span class="no">landcover_coma_e</span>
<span class="co">#&gt; # A tibble: 22 x 3</span>
<span class="co">#&gt;       id na_prop signature        </span>
<span class="co">#&gt;  * &lt;int&gt;   &lt;dbl&gt; &lt;list&gt;           </span>
<span class="co">#&gt;  1     1 0.114   &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  2     2 0.0851  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  3     3 0.0377  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  4     4 0.0914  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  5     5 0       &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  6     6 0       &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  7     7 0.00285 &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  8     8 0.0720  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  9     9 0.0508  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt; 10    10 0       &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt; # … with 12 more rows</span></pre></body></html></div>
<p>The output, <code>landcover_coma_e</code>, is also of the <code>lsp</code> class and contains three columns. The first column, <code>id</code>, has the same values as provided in the <code>window</code> argument above. The third column, <code>signature</code>, has a spatial signature for each polygon in the <code>ecoregions</code> dataset.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">landcover_coma_e</span>$<span class="no">signature</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="co">#&gt;     1     2 3  4 5 6    7</span>
<span class="co">#&gt; 1 662   752 0  1 0 0   13</span>
<span class="co">#&gt; 2 752 70974 0  6 0 0  427</span>
<span class="co">#&gt; 3   0     0 0  0 0 0    0</span>
<span class="co">#&gt; 4   1     6 0 12 0 0    4</span>
<span class="co">#&gt; 5   0     0 0  0 0 0    0</span>
<span class="co">#&gt; 6   0     0 0  0 0 0    0</span>
<span class="co">#&gt; 7  13   427 0  4 0 0 1560</span></pre></body></html></div>
</div>
</div>
<div id="large-data-support" class="section level2">
<h2 class="hasAnchor">
<a href="#large-data-support" class="anchor"></a>Large data support</h2>
<p>The <strong>motif</strong> package also supports large raster datasets, including rasters that do not fit into the RAM. It just requres reading the input data as a <code>stars.proxy</code> by adding <code>proxy = TRUE</code> to the <code><a href="https://rdrr.io/pkg/stars/man/read_stars.html">read_stars()</a></code> function:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">landcover_proxy</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stars/man/read_stars.html">read_stars</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"raster/landcover2015.tif"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"motif"</span>),
                             <span class="kw">proxy</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>The rest of the calculations are the same as above.</p>
</div>
<div id="applications" class="section level2">
<h2 class="hasAnchor">
<a href="#applications" class="anchor"></a>Applications</h2>
<p>Importantly, spatial patterns’ signatures can be used not only to describe landscapes, but also to search for other similar landscapes, compare landscapes, and cluster them.</p>
<!-- create a summary image -->
<p>You can find examples of each of the above applications in the vignettes:</p>
<ol style="list-style-type: decimal">
<li><a href="https://nowosad.github.io/motif/articles/articles/search.html">Spatial patterns’ search</a></li>
<li><a href="https://nowosad.github.io/motif/articles/articles/compare.html">Spatial patterns’ comparision</a></li>
<li><a href="https://nowosad.github.io/motif/articles/articles/cluster.html">Spatial patterns’ clustering</a></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
