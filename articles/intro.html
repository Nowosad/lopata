<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the motif package • motif</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the motif package">
<meta property="og:description" content="motif">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motif</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/articles/cluster.html">Cluster</a>
    </li>
    <li>
      <a href="../articles/articles/compare.html">Compare</a>
    </li>
    <li>
      <a href="../articles/articles/search.html">Search</a>
    </li>
    <li>
      <a href="../articles/articles/signatures.html">Signatures</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction to the motif package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Nowosad/motif/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the motif package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Nowosad/motif/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">motif</span>)</pre></body></html></div>
<p>The <strong>motif</strong> package works on raster data represented by <code>stars</code> objects. It has several example datasets, including <code>"raster/landcover2015.tif"</code>. This file contains a land cover data for New Guinea, with seven possible categories: (1) agriculture, (2) forest, (3) grassland, (5) settlement, (6) shrubland, (7) sparse vegetation, and (9) water.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">motif</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stars</span>)
<span class="co">#&gt; Loading required package: abind</span>
<span class="co">#&gt; Loading required package: sf</span>
<span class="co">#&gt; Linking to GEOS 3.8.1, GDAL 2.4.4, PROJ 7.0.0</span>
<span class="no">landcover</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stars/man/read_stars.html">read_stars</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"raster/landcover2015.tif"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"motif"</span>))
<span class="no">landcover</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span>(<span class="no">landcover</span>)
<span class="fu"><a href="https://rdrr.io/pkg/stars/man/plot.html">plot</a></span>(<span class="no">landcover</span>, <span class="kw">key.pos</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">key.width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">lcm</a></span>(<span class="fl">5</span>))</pre></body></html></div>
<p><img src="intro_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div id="signatures" class="section level3">
<h3 class="hasAnchor">
<a href="#signatures" class="anchor"></a>Signatures</h3>
<p>We can see that most of the island is covered by forest, with some agriculture and smaller areas of the other classes. It is also reasonably easy to describe these proportions (so-called composition) numerically - we just need to count cells of each category for the whole data.</p>
<p>We can use the <code><a href="../reference/lsp_thumbprint.html">lsp_thumbprint()</a></code> function for this. It requires a <code>stars</code> object as the first input and the type of a signature to calculate - <code>"composition"</code> in this case. There are also several additional arguments, including <code>threshold</code> - a share (between 0 and 1) of NA cells to allow signature calculation and <code>normalization</code> - decision if the output vector should be normalized.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">landcover_comp</span> <span class="kw">=</span> <span class="fu"><a href="../reference/lsp_thumbprint.html">lsp_thumbprint</a></span>(<span class="no">landcover</span>,
                                <span class="kw">type</span> <span class="kw">=</span> <span class="st">"composition"</span>,
                                <span class="kw">threshold</span> <span class="kw">=</span> <span class="fl">1</span>,
                                <span class="kw">normalization</span> <span class="kw">=</span> <span class="st">"none"</span>)
<span class="no">landcover_comp</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;      id na_prop signature        </span>
<span class="co">#&gt; * &lt;int&gt;   &lt;dbl&gt; &lt;list&gt;           </span>
<span class="co">#&gt; 1     1   0.666 &lt;int[,7] [1 × 7]&gt;</span></pre></body></html></div>
<p>The output of <code><a href="../reference/lsp_thumbprint.html">lsp_thumbprint()</a></code> has a new class <code>lsp</code>. It is a tibble with three columns:</p>
<ul>
<li>
<code>id</code> - an id of each window (area)</li>
<li>
<code>na_prop</code> - share (0-1) of <code>NA</code> cells for each window</li>
<li>
<code>signature</code> - a list-column containing with calculated signatures</li>
</ul>
<p>We can take a look at the last column:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">landcover_comp</span>$<span class="no">signature</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;           1       2     3    4    5     6      7</span>
<span class="co">#&gt; [1,] 862001 8122776 84482 4311 2677 78555 203444</span></pre></body></html></div>
<p>It is a list of signatures. In this case, we have just one signature describing the whole area in the form of a numeric vector. It contains how many cells belong to each land cover category. For example, there are 8122776 cells of forest, but only 2677 cells of shrubland.</p>
<!-- However, it is not that easy to describe landscape patterns numericaly.  -->
<!-- We can try to... -->
<!-- ... -->
<!-- ... -->
<p>Another approach would be to divide this large area into many regular rectangles (we refer to them as local landscapes) and to calculate a signature in each of them. The previously used signature, <code>"composition"</code> has one important flaw though. It only describes how many cells of each category we have. However, it does not distinguish an area with the left half of forest and right half of agriculture from an area with forest mixed with agriculture (think of a checkerboard). Gladly, several more types of signatures exist. It includes a co-occurrence matrix (<code>type = "coma"</code>). <code>"coma"</code> goes to each cell, looks at its value, looks at the values of its neighbors and counts how many neighbors of each class our central cell has.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">landcover_coma</span> <span class="kw">=</span> <span class="fu"><a href="../reference/lsp_thumbprint.html">lsp_thumbprint</a></span>(<span class="no">landcover</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"coma"</span>, <span class="kw">window</span> <span class="kw">=</span> <span class="fl">200</span>)
<span class="no">landcover_coma</span>
<span class="co">#&gt; # A tibble: 232 x 3</span>
<span class="co">#&gt;       id na_prop signature        </span>
<span class="co">#&gt;  * &lt;int&gt;   &lt;dbl&gt; &lt;list&gt;           </span>
<span class="co">#&gt;  1     3  0.0992 &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  2     4  0.145  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  3    38  0.255  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  4    39  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  5    40  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  6    41  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  7    42  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  8    43  0.115  &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt;  9    77  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt; 10    78  0      &lt;int[,7] [7 × 7]&gt;</span>
<span class="co">#&gt; # … with 222 more rows</span></pre></body></html></div>
<p>Now, we have one row per local landscape, where each local landscape is described by an id (<code>id</code>), the proportion of cells with <code>NA</code>s (<code>na_prop</code>), and a signature (<code>signature</code>). For example, the first signature looks like this:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">landcover_coma</span>$<span class="no">signature</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="co">#&gt;    1      2 3 4 5 6    7</span>
<span class="co">#&gt; 1 32     47 0 2 0 0    6</span>
<span class="co">#&gt; 2 47 141250 0 7 0 0  226</span>
<span class="co">#&gt; 3  0      0 0 0 0 0    0</span>
<span class="co">#&gt; 4  2      7 0 4 0 0    0</span>
<span class="co">#&gt; 5  0      0 0 0 0 0    0</span>
<span class="co">#&gt; 6  0      0 0 0 0 0    0</span>
<span class="co">#&gt; 7  6    226 0 0 0 0 1462</span></pre></body></html></div>
<p>It is a matrix where each row and column represent subsequent land cover classes. For example, 141250 times forest cell is next to anther forest cell, and 226 times water cell is next to forest cell. You can learn more about this signature at <a href="https://nowosad.github.io/comat/articles/coma.html" class="uri">https://nowosad.github.io/comat/articles/coma.html</a>.</p>
<p>Importantly, this and some other signatures can be used not only to describe landscapes, but also to search for other similar landscapes, compare landscapes, and cluster them.</p>
<!-- create a summary image -->
<!-- You can find examples of each of the above applications in the vignettes: -->
<!-- ref to vig -->
<!-- ### Search -->
<!-- ### Compare -->
<!-- ### Cluster -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
