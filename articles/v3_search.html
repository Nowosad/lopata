<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial patterns' search • motif</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial patterns' search">
<meta property="og:description" content="motif">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motif</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v2_signatures.html">Types of spatial patterns' signatures</a>
    </li>
    <li>
      <a href="../articles/v3_search.html">Spatial patterns' search</a>
    </li>
    <li>
      <a href="../articles/v4_compare.html">Spatial patterns' comparision</a>
    </li>
    <li>
      <a href="../articles/v5_cluster.html">Spatial patterns' clustering</a>
    </li>
    <li>
      <a href="../articles/v6_composition.html">Extracting the proportion of different classes in many regular local landscapes</a>
    </li>
    <li>
      <a href="../articles/v1_intro.html">Introduction to the motif package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Nowosad/motif/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v3_search_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spatial patterns’ search</h1>
                        <h4 data-toc-skip class="author">Jakub Nowosad</h4>
            
            <h4 data-toc-skip class="date">2022-05-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Nowosad/motif/blob/HEAD/vignettes/articles/v3_search.Rmd" class="external-link"><code>vignettes/articles/v3_search.Rmd</code></a></small>
      <div class="hidden name"><code>v3_search.Rmd</code></div>

    </div>

    
    
<p>The pattern-based spatial analysis makes it possible to search for areas with similar spatial patterns. This vignette shows how to do spatial patterns’ search on example datasets. Let’s start by attaching necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nowosad.github.io/motif/" class="external-link">motif</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: abind</span>
<span class="co">#&gt; Loading required package: sf</span>
<span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.2, PROJ 7.2.0; sf_use_s2() is TRUE</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap" class="external-link">tmap</a></span><span class="op">)</span></code></pre></div>
<p>Spatial patterns’ search requires two spatial objects. The first one is the area of interest, and the second one is a larger area that we want to search in. For this vignette, we read the <code>"raster/landcover2015.tif"</code> file, and crop our area of interest using coordinates of its borders.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">landcover</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"raster/landcover2015.tif"</span>, package <span class="op">=</span> <span class="st">"motif"</span><span class="op">)</span><span class="op">)</span>

<span class="va">ext</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">238000</span>, xmax <span class="op">=</span> <span class="fl">268000</span>,
                ymin <span class="op">=</span> <span class="op">-</span><span class="fl">819814</span>, ymax <span class="op">=</span> <span class="op">-</span><span class="fl">789814</span><span class="op">)</span>,
                crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">landcover</span><span class="op">)</span><span class="op">)</span>

<span class="va">landcover_ext</span> <span class="op">=</span> <span class="va">landcover</span><span class="op">[</span><span class="va">ext</span><span class="op">]</span></code></pre></div>
<p>The <code>landcover_ext</code> represents area mostly covered by forest with some agriculture.</p>
<p><img src="v3_search_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>We want to compare it to the land cover dataset of New Guinea - <code>landcover</code>.</p>
<pre><code><span class="co">#&gt; downsample set to 12</span></code></pre>
<p><img src="v3_search_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="section level2">
<h2 id="regular-local-landscapes">Regular local landscapes<a class="anchor" aria-label="anchor" href="#regular-local-landscapes"></a>
</h2>
<p>Spatial patterns’ search is done by the <code><a href="../reference/lsp_search.html">lsp_search()</a></code> function. It expects an area of interest as the first object and the larger area as the second one. We should provide the type of signature (<code>type</code>) and the suitable distance function (<code>dist_fun</code>) that we want to use to compare two datasets. Additional arguments include the size of the search window from the larger area (<code>window</code>) and how much of NA values we can accept in the local landscapes (<code>threshold</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">search_1</span> <span class="op">=</span> <span class="fu"><a href="../reference/lsp_search.html">lsp_search</a></span><span class="op">(</span><span class="va">landcover_ext</span>, <span class="va">landcover</span>, 
                      type <span class="op">=</span> <span class="st">"cove"</span>, dist_fun <span class="op">=</span> <span class="st">"jensen-shannon"</span>,
                      window <span class="op">=</span> <span class="fl">100</span>, threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Metric: 'jensen-shannon' using unit: 'log2'.</span>
<span class="va">search_1</span>
<span class="co">#&gt; stars object with 2 dimensions and 3 attributes</span>
<span class="co">#&gt; attribute(s):</span>
<span class="co">#&gt;                  Min.      1st Qu. Median         Mean 3rd Qu. Max.</span>
<span class="co">#&gt; id       1.0000000000 722.25000000 1443.5 1443.5000000 2164.75 2886</span>
<span class="co">#&gt; na_prop  0.0000000000   0.00220000    1.0    0.6757365    1.00    1</span>
<span class="co">#&gt; dist     0.0001794214   0.05387658    0.5    0.3352646    0.50    1</span>
<span class="co">#&gt; dimension(s):</span>
<span class="co">#&gt;   from to   offset  delta  refsys point values x/y</span>
<span class="co">#&gt; x    1 74 -1091676  30000 unnamed    NA   NULL [x]</span>
<span class="co">#&gt; y    1 39 -38556.5 -30000 unnamed    NA   NULL [y]</span></code></pre></div>
<p>The result of the <code><a href="../reference/lsp_search.html">lsp_search()</a></code> function is a <code>stars</code> object with three attributes:</p>
<ul>
<li>
<code>id</code> - unique value for each local landscape</li>
<li>
<code>na_prop</code> - proportion (0-1) of NA values in each local landscapes</li>
<li>
<code>dist</code> - the distance between our area of interest and each local landscape</li>
</ul>
<p>We can visualize the results, using, for example, the <strong>tmap</strong> package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_breaks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">search_1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span><span class="st">"dist"</span>, breaks <span class="op">=</span> <span class="va">my_breaks</span>, palette <span class="op">=</span> <span class="st">"-viridis"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html" class="external-link">tm_layout</a></span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="v3_search_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>It is now possible to see that there are several areas with a distance below 0.001 represented by a yellow color - they are the most similar to <code>landcover_ext</code>.</p>
<p>We can find their ids using the code below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">search_1</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">search_1</span><span class="op">$</span><span class="va">dist</span> <span class="op">&lt;</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;  [1]  690  856 1136 1386 1439 1440 1668 1895 1896 1968</span></code></pre></div>
<p>To extract selected local landscape, the <code><a href="../reference/lsp_extract.html">lsp_extract()</a></code> function can be used.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">search_1_690</span> <span class="op">=</span> <span class="fu"><a href="../reference/lsp_extract.html">lsp_extract</a></span><span class="op">(</span><span class="va">landcover</span>,
                            window <span class="op">=</span> <span class="fl">100</span>,
                            id <span class="op">=</span> <span class="fl">690</span><span class="op">)</span></code></pre></div>
<p>Its output is a <code>stars</code> object, that we can vizualize and see that it is fairly similar to the area of interest.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">search_1_690</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">search_1_690</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/stars/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">search_1_690</span>, main <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="v3_search_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="irregular-local-landscapes">Irregular local landscapes<a class="anchor" aria-label="anchor" href="#irregular-local-landscapes"></a>
</h2>
<p>Search is also possible in irregular local landscapes, based on polygon data. <code>ecoregions.gpkg</code> contains terrestrial ecoregions for New Guinea from <a href="https://ecoregions2017.appspot.com/" class="external-link uri">https://ecoregions2017.appspot.com/</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ecoregions</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vector/ecoregions.gpkg"</span>, package <span class="op">=</span> <span class="st">"motif"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This dataset has 22 rows, where each row relates to one ecoregion. Each ecoregion is also related to a unique value in the <code>id</code> column.</p>
<p><img src="v3_search_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>The <code><a href="../reference/lsp_search.html">lsp_search()</a></code> function works very similarly to the previous case - we just need to provide our ecoregions in the <code>window</code> argument.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">search_2</span> <span class="op">=</span> <span class="fu"><a href="../reference/lsp_search.html">lsp_search</a></span><span class="op">(</span><span class="va">landcover_ext</span>, <span class="va">landcover</span>, 
                      type <span class="op">=</span> <span class="st">"cove"</span>, dist_fun <span class="op">=</span> <span class="st">"jensen-shannon"</span>,
                      window <span class="op">=</span> <span class="va">ecoregions</span><span class="op">[</span><span class="st">"id"</span><span class="op">]</span>, threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Metric: 'jensen-shannon' using unit: 'log2'.</span>
<span class="va">search_2</span>
<span class="co">#&gt; stars object with 2 dimensions and 3 attributes</span>
<span class="co">#&gt; attribute(s), summary of first 1e+05 cells:</span>
<span class="co">#&gt;                  Min.      1st Qu.       Median         Mean      3rd Qu.</span>
<span class="co">#&gt; id       21.000000000 21.000000000 21.000000000 21.000000000 21.000000000</span>
<span class="co">#&gt; na_prop   0.007177053  0.007177053  0.007177053  0.007177053  0.007177053</span>
<span class="co">#&gt; dist      0.016081750  0.016081750  0.016081750  0.016081750  0.016081750</span>
<span class="co">#&gt;                  Max.  NA's</span>
<span class="co">#&gt; id       21.000000000 98383</span>
<span class="co">#&gt; na_prop   0.007177053 98383</span>
<span class="co">#&gt; dist      0.016081750 98383</span>
<span class="co">#&gt; dimension(s):</span>
<span class="co">#&gt;   from   to   offset delta  refsys point values x/y</span>
<span class="co">#&gt; x    1 7360 -1091676   300 unnamed FALSE   NULL [x]</span>
<span class="co">#&gt; y    1 3812 -38556.5  -300 unnamed FALSE   NULL [y]</span></code></pre></div>
<p>Let’s vizualize the output:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_breaks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">search_2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html" class="external-link">tm_raster</a></span><span class="op">(</span><span class="st">"dist"</span>, breaks <span class="op">=</span> <span class="va">my_breaks</span>, palette <span class="op">=</span> <span class="st">"-viridis"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">ecoregions</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html" class="external-link">tm_layout</a></span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; stars object downsampled to 1390 by 720 cells. See tm_shape manual (argument raster.downsample)</span></code></pre></div>
<p><img src="v3_search_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>This search shows that most of the polygons are fairly different from our area of interest. Only one of them, located in the east, has a relatively small distance of about 0.007.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">min_search2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">min</a></span><span class="op">(</span><span class="va">search_2</span><span class="op">$</span><span class="va">dist</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">min_search2</span>
<span class="co">#&gt; [1] 0.006810959</span></code></pre></div>
<p>We can obtain its id (<code>10</code>) using the code below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">search_2</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">search_2</span><span class="op">$</span><span class="va">dist</span> <span class="op">==</span> <span class="va">min_search2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 10</span></code></pre></div>
<p>Now, we can use <code><a href="../reference/lsp_extract.html">lsp_extract()</a></code> to extract land cover for this ecoregion.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">search_2_10</span> <span class="op">=</span> <span class="fu"><a href="../reference/lsp_extract.html">lsp_extract</a></span><span class="op">(</span><span class="va">landcover</span>,
                          window <span class="op">=</span> <span class="va">ecoregions</span><span class="op">[</span><span class="st">"id"</span><span class="op">]</span>,
                          id <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>This local landscape is also mostly covered by forest with just some smaller areas of agriculture.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">search_2_10</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">search_2_10</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/stars/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">search_2_10</span>, main <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="v3_search_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
